Lmod Warning: The system MODULEPATH has changed: please rebuild your saved
collection.




Lmod is automatically replacing "nvhpc/23.9" with "gcc-native/12.3".


Lmod is automatically replacing "PrgEnv-nvhpc/8.5.0" with "PrgEnv-gnu/8.5.0".


Due to MODULEPATH changes, the following have been reloaded:
  1) cray-mpich/8.1.28

/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/transformers/training_args.py:1525: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/transformers/training_args.py:1525: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/transformers/training_args.py:1525: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/transformers/training_args.py:1525: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
`low_cpu_mem_usage` was None, now set to True since model is quantized.
`low_cpu_mem_usage` was None, now set to True since model is quantized.
Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards:   0%|          | 0/4 [00:00<?, ?it/s]Downloading shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:00<00:00, 18.86it/s]Downloading shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:00<00:00, 20.09it/s]Downloading shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 20.12it/s]
Downloading shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 19.34it/s]Downloading shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 19.26it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:10<00:30, 10.26s/it]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:10<00:31, 10.51s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:18<00:18,  9.22s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:19<00:18,  9.40s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:28<00:09,  9.45s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:28<00:09,  9.56s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:29<00:00,  6.17s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:29<00:00,  7.44s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:29<00:00,  6.21s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:29<00:00,  7.46s/it]
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py:100: FutureWarning: Deprecated argument(s) used in '__init__': dataset_text_field, max_seq_length, packing. Will not be supported from version '1.0.0'.

Deprecated positional argument(s) used in SFTTrainer, please use the SFTConfig to set these arguments instead.
  warnings.warn(message, FutureWarning)
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/transformers/training_args.py:1525: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:192: UserWarning: You passed a `packing` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.
  warnings.warn(
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py:100: FutureWarning: Deprecated argument(s) used in '__init__': dataset_text_field, max_seq_length, packing. Will not be supported from version '1.0.0'.

Deprecated positional argument(s) used in SFTTrainer, please use the SFTConfig to set these arguments instead.
  warnings.warn(message, FutureWarning)
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/transformers/training_args.py:1525: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:192: UserWarning: You passed a `packing` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.
  warnings.warn(
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:280: UserWarning: You passed a `max_seq_length` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.
  warnings.warn(
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a `dataset_text_field` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.
  warnings.warn(
Generating train split: 0 examples [00:00, ? examples/s]/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:280: UserWarning: You passed a `max_seq_length` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.
  warnings.warn(
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a `dataset_text_field` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.
  warnings.warn(
Generating train split: 1 examples [00:00,  1.51 examples/s]Generating train split: 522 examples [00:00, 909.05 examples/s]Generating train split: 808 examples [00:01, 659.01 examples/s]Generating train split: 1000 examples [00:01, 688.44 examples/s]Generating train split: 1561 examples [00:01, 1336.72 examples/s]Generating train split: 1886 examples [00:02, 965.07 examples/s] Generating train split: 2270 examples [00:02, 1265.40 examples/s]Generating train split: 2695 examples [00:02, 1016.20 examples/s]Generating train split: 3000 examples [00:03, 1203.31 examples/s]Generating train split: 3235 examples [00:03, 877.38 examples/s] Generating train split: 3781 examples [00:03, 1371.28 examples/s]Generating train split: 4320 examples [00:04, 1006.19 examples/s]Generating train split: 4804 examples [00:04, 1356.31 examples/s]Generating train split: 5272 examples [00:05, 1079.21 examples/s]Generating train split: 5652 examples [00:05, 948.34 examples/s] Generating train split: 6000 examples [00:05, 1147.50 examples/s]Generating train split: 6461 examples [00:06, 1003.59 examples/s]Generating train split: 7000 examples [00:06, 1339.07 examples/s]Generating train split: 7265 examples [00:07, 908.22 examples/s] Generating train split: 7820 examples [00:07, 1319.96 examples/s]Generating train split: 8328 examples [00:07, 1089.95 examples/s]Generating train split: 8870 examples [00:08, 1023.25 examples/s]Generating train split: 9263 examples [00:08, 1229.33 examples/s]Generating train split: 9676 examples [00:09, 1033.17 examples/s]Generating train split: 10000 examples [00:09, 1080.12 examples/s]Generating train split: 10484 examples [00:10, 993.52 examples/s] Generating train split: 11000 examples [00:10, 1306.74 examples/s]Generating train split: 11291 examples [00:10, 992.54 examples/s] Generating train split: 11832 examples [00:10, 1410.21 examples/s]Generating train split: 12364 examples [00:11, 1135.87 examples/s]Generating train split: 12906 examples [00:12, 967.34 examples/s] Generating train split: 13259 examples [00:12, 1144.01 examples/s]Generating train split: 13712 examples [00:12, 1005.33 examples/s]Generating train split: 14000 examples [00:13, 1141.26 examples/s]Generating train split: 14522 examples [00:13, 1042.29 examples/s]Generating train split: 15000 examples [00:13, 1333.52 examples/s]Generating train split: 15325 examples [00:14, 1016.79 examples/s]Generating train split: 15865 examples [00:14, 1435.17 examples/s]Generating train split: 16406 examples [00:15, 1045.79 examples/s]Generating train split: 16944 examples [00:15, 991.40 examples/s] Generating train split: 17267 examples [00:15, 1152.76 examples/s]Generating train split: 17728 examples [00:16, 1497.20 examples/s]Generating train split: 18269 examples [00:16, 1164.44 examples/s]Generating train split: 18560 examples [00:17, 941.87 examples/s] Generating train split: 19000 examples [00:17, 1071.54 examples/s]Generating train split: 19366 examples [00:18, 917.90 examples/s] Generating train split: 19899 examples [00:18, 1305.20 examples/s]Generating train split: 20172 examples [00:18, 933.44 examples/s] Generating train split: 20707 examples [00:18, 1340.18 examples/s]Generating train split: 21244 examples [00:19, 1089.51 examples/s]Generating train split: 21728 examples [00:19, 1423.00 examples/s]Generating train split: 22267 examples [00:20, 1039.25 examples/s]Generating train split: 22592 examples [00:21, 892.42 examples/s] Generating train split: 23000 examples [00:21, 1099.36 examples/s]Generating train split: 23396 examples [00:21, 947.01 examples/s] Generating train split: 23933 examples [00:21, 1335.75 examples/s]Generating train split: 24467 examples [00:22, 1105.05 examples/s]Generating train split: 25000 examples [00:22, 1416.51 examples/s]Generating train split: 25279 examples [00:23, 942.33 examples/s] Generating train split: 25818 examples [00:23, 1323.74 examples/s]Generating train split: 26263 examples [00:24, 1040.21 examples/s]Generating train split: 26629 examples [00:24, 897.44 examples/s] Generating train split: 27000 examples [00:24, 1087.56 examples/s]Generating train split: 27434 examples [00:25, 960.77 examples/s] Generating train split: 27918 examples [00:25, 1295.63 examples/s]Generating train split: 28240 examples [00:26, 876.06 examples/s] Generating train split: 28701 examples [00:26, 1187.42 examples/s]Generating train split: 29000 examples [00:26, 1367.86 examples/s]Generating train split: 29309 examples [00:27, 999.60 examples/s] Generating train split: 29846 examples [00:27, 1462.09 examples/s]Generating train split: 30262 examples [00:27, 1080.72 examples/s]Generating train split: 30647 examples [00:28, 924.68 examples/s] Generating train split: 31000 examples [00:28, 1133.06 examples/s]Generating train split: 31453 examples [00:29, 886.09 examples/s] Generating train split: 31990 examples [00:29, 1266.96 examples/s]Generating train split: 32520 examples [00:29, 1057.60 examples/s]Generating train split: 33000 examples [00:30, 1331.56 examples/s]Generating train split: 33333 examples [00:30, 1020.27 examples/s]Generating train split: 33871 examples [00:30, 1420.67 examples/s]Generating train split: 34262 examples [00:31, 1048.40 examples/s]Generating train split: 34683 examples [00:32, 856.22 examples/s] Generating train split: 35000 examples [00:32, 1006.77 examples/s]Generating train split: 35489 examples [00:32, 939.23 examples/s] Generating train split: 36000 examples [00:33, 1243.01 examples/s]Generating train split: 36299 examples [00:33, 952.83 examples/s] Generating train split: 36828 examples [00:33, 1348.92 examples/s]Generating train split: 37105 examples [00:34, 852.17 examples/s] Generating train split: 37639 examples [00:34, 1233.50 examples/s]Generating train split: 38000 examples [00:35, 938.36 examples/s] Generating train split: 38495 examples [00:35, 1278.98 examples/s]Generating train split: 38973 examples [00:35, 1090.91 examples/s]Generating train split: 39263 examples [00:36, 1225.34 examples/s]Generating train split: 39516 examples [00:36, 909.38 examples/s] Generating train split: 40000 examples [00:36, 1237.36 examples/s]Generating train split: 40324 examples [00:37, 862.21 examples/s] Generating train split: 40858 examples [00:37, 1264.77 examples/s]Generating train split: 41393 examples [00:38, 1043.40 examples/s]Generating train split: 41924 examples [00:38, 1424.39 examples/s]Generating train split: 42252 examples [00:38, 1014.26 examples/s]Generating train split: 42744 examples [00:39, 933.68 examples/s] Generating train split: 43000 examples [00:39, 943.41 examples/s]Generating train split: 43521 examples [00:39, 1341.68 examples/s]Generating train split: 43812 examples [00:40, 997.13 examples/s] Generating train split: 44259 examples [00:40, 1288.17 examples/s]Generating train split: 44615 examples [00:41, 1001.13 examples/s]Generating train split: 45000 examples [00:41, 1246.10 examples/s]Generating train split: 45418 examples [00:41, 998.78 examples/s] Generating train split: 45945 examples [00:42, 1413.35 examples/s]Generating train split: 46255 examples [00:42, 881.58 examples/s] Generating train split: 46728 examples [00:42, 1203.48 examples/s]Generating train split: 47256 examples [00:43, 1012.18 examples/s]Generating train split: 47579 examples [00:44, 858.72 examples/s] Generating train split: 48000 examples [00:44, 1099.21 examples/s]Generating train split: 48385 examples [00:44, 931.63 examples/s] Generating train split: 48903 examples [00:44, 1311.19 examples/s]Generating train split: 49191 examples [00:45, 842.52 examples/s] Generating train split: 49720 examples [00:45, 1215.16 examples/s]Generating train split: 50258 examples [00:46, 1021.48 examples/s]Generating train split: 50757 examples [00:46, 1342.55 examples/s]Generating train split: 51250 examples [00:47, 1066.27 examples/s]Generating train split: 51609 examples [00:47, 855.34 examples/s] Generating train split: 52000 examples [00:48, 1061.94 examples/s]Generating train split: 52413 examples [00:48, 921.96 examples/s] Generating train split: 52933 examples [00:48, 1286.84 examples/s]Generating train split: 53219 examples [00:49, 880.80 examples/s] Generating train split: 53736 examples [00:49, 1248.36 examples/s]Generating train split: 54280 examples [00:50, 1009.56 examples/s]Generating train split: 54801 examples [00:50, 1364.18 examples/s]Generating train split: 55253 examples [00:51, 950.37 examples/s] Generating train split: 55642 examples [00:51, 847.03 examples/s]Generating train split: 56000 examples [00:52, 1016.22 examples/s]Generating train split: 56457 examples [00:52, 922.00 examples/s] Generating train split: 56978 examples [00:52, 1280.75 examples/s]Generating train split: 57257 examples [00:52, 1426.68 examples/s]Generating train split: 57784 examples [00:53, 1138.22 examples/s]Generating train split: 58072 examples [00:54, 779.88 examples/s] Generating train split: 58597 examples [00:54, 1128.04 examples/s]Generating train split: 58879 examples [00:54, 875.79 examples/s] Generating train split: 59254 examples [00:55, 1099.61 examples/s]Generating train split: 59682 examples [00:55, 931.19 examples/s] Generating train split: 60000 examples [00:55, 1094.81 examples/s]Generating train split: 60488 examples [00:56, 898.58 examples/s] Generating train split: 61000 examples [00:56, 1204.22 examples/s]Generating train split: 61293 examples [00:57, 933.12 examples/s] Generating train split: 61812 examples [00:57, 1323.94 examples/s]Generating train split: 62097 examples [00:57, 920.80 examples/s] Generating train split: 62619 examples [00:58, 1317.48 examples/s]Generating train split: 63000 examples [00:58, 972.11 examples/s] Generating train split: 63391 examples [00:58, 1240.32 examples/s]Generating train split: 63709 examples [00:59, 856.97 examples/s] Generating train split: 64000 examples [00:59, 1005.26 examples/s]Generating train split: 64507 examples [00:59, 1446.62 examples/s]Generating train split: 65000 examples [01:00, 1077.86 examples/s]Generating train split: 65327 examples [01:01, 867.47 examples/s] Generating train split: 65846 examples [01:01, 1236.79 examples/s]Generating train split: 66132 examples [01:01, 884.02 examples/s] Generating train split: 66643 examples [01:01, 1258.40 examples/s]Generating train split: 67000 examples [01:02, 850.75 examples/s] Generating train split: 67394 examples [01:02, 1105.56 examples/s]Generating train split: 67746 examples [01:03, 907.66 examples/s] Generating train split: 68000 examples [01:03, 1029.98 examples/s]Generating train split: 68505 examples [01:03, 1482.95 examples/s]Generating train split: 68810 examples [01:04, 1027.53 examples/s]Generating train split: 69255 examples [01:04, 1332.51 examples/s]Generating train split: 69618 examples [01:05, 880.93 examples/s] Generating train split: 70000 examples [01:05, 1092.31 examples/s]Generating train split: 70420 examples [01:05, 931.91 examples/s] Generating train split: 70942 examples [01:05, 1326.63 examples/s]Generating train split: 71253 examples [01:06, 920.46 examples/s] Generating train split: 71755 examples [01:06, 1291.71 examples/s]Generating train split: 72247 examples [01:07, 1021.35 examples/s]Generating train split: 72581 examples [01:08, 783.29 examples/s] Generating train split: 73000 examples [01:08, 1010.13 examples/s]Generating train split: 73389 examples [01:08, 863.62 examples/s] Generating train split: 73912 examples [01:09, 1227.32 examples/s]Generating train split: 74195 examples [01:09, 884.99 examples/s] Generating train split: 74708 examples [01:09, 1257.47 examples/s]Generating train split: 75248 examples [01:10, 1031.17 examples/s]Generating train split: 75755 examples [01:10, 1356.65 examples/s]Generating train split: 76248 examples [01:11, 966.38 examples/s] Generating train split: 76610 examples [01:11, 850.56 examples/s]Generating train split: 77000 examples [01:12, 1037.04 examples/s]Generating train split: 77416 examples [01:12, 908.76 examples/s] Generating train split: 77927 examples [01:12, 1261.37 examples/s]Generating train split: 78221 examples [01:13, 905.37 examples/s] Generating train split: 78738 examples [01:13, 1279.16 examples/s]Generating train split: 79289 examples [01:14, 952.74 examples/s] Generating train split: 79806 examples [01:14, 1288.51 examples/s]Generating train split: 80250 examples [01:15, 1007.35 examples/s]Generating train split: 80644 examples [01:15, 877.14 examples/s] Generating train split: 81000 examples [01:15, 1043.13 examples/s]Generating train split: 81453 examples [01:16, 929.71 examples/s] Generating train split: 81965 examples [01:16, 1284.26 examples/s]Generating train split: 82251 examples [01:16, 1432.44 examples/s]Generating train split: 82518 examples [01:17, 890.98 examples/s] Generating train split: 83000 examples [01:17, 1207.32 examples/s]Generating train split: 83314 examples [01:18, 905.19 examples/s] Generating train split: 83827 examples [01:18, 1302.68 examples/s]Generating train split: 84242 examples [01:19, 968.57 examples/s] Generating train split: 84678 examples [01:19, 789.23 examples/s]Generating train split: 85000 examples [01:19, 956.12 examples/s]Generating train split: 85383 examples [01:20, 1228.06 examples/s]Generating train split: 85738 examples [01:20, 956.80 examples/s] Generating train split: 86000 examples [01:20, 1084.05 examples/s]Generating train split: 86292 examples [01:21, 830.02 examples/s] Generating train split: 86775 examples [01:21, 1198.25 examples/s]Generating train split: 87102 examples [01:22, 881.57 examples/s] Generating train split: 87616 examples [01:22, 1285.49 examples/s]Generating train split: 87909 examples [01:22, 829.86 examples/s] Generating train split: 88250 examples [01:23, 1010.53 examples/s]Generating train split: 88704 examples [01:23, 902.09 examples/s] Generating train split: 89000 examples [01:23, 1074.97 examples/s]Generating train split: 89497 examples [01:23, 1514.34 examples/s]Generating train split: 90000 examples [01:24, 1079.14 examples/s]Generating train split: 90310 examples [01:25, 871.02 examples/s] Generating train split: 90819 examples [01:25, 1234.29 examples/s]Generating train split: 91121 examples [01:26, 807.71 examples/s] Generating train split: 91583 examples [01:26, 1102.83 examples/s]Generating train split: 91925 examples [01:26, 899.40 examples/s] Generating train split: 92248 examples [01:26, 1062.19 examples/s]Generating train split: 92729 examples [01:27, 945.09 examples/s] Generating train split: 93000 examples [01:27, 1097.30 examples/s]Generating train split: 93496 examples [01:27, 1538.93 examples/s]Generating train split: 93788 examples [01:28, 898.28 examples/s] Generating train split: 94246 examples [01:28, 1194.12 examples/s]Generating train split: 94593 examples [01:29, 919.21 examples/s] Generating train split: 95000 examples [01:29, 1145.59 examples/s]Generating train split: 95401 examples [01:30, 942.52 examples/s] Generating train split: 95867 examples [01:30, 1263.96 examples/s]Generating train split: 96245 examples [01:30, 931.10 examples/s] Generating train split: 96745 examples [01:30, 1297.00 examples/s]Generating train split: 97243 examples [01:31, 934.47 examples/s] Generating train split: 97576 examples [01:32, 811.78 examples/s]Generating train split: 98000 examples [01:32, 1046.81 examples/s]Generating train split: 98381 examples [01:33, 872.78 examples/s] Generating train split: 98893 examples [01:33, 1229.66 examples/s]Generating train split: 99195 examples [01:33, 886.58 examples/s] Generating train split: 99705 examples [01:33, 1253.75 examples/s]Generating train split: 100000 examples [01:34, 806.89 examples/s]Generating train split: 100374 examples [01:34, 1045.31 examples/s]Generating train split: 100803 examples [01:35, 910.77 examples/s] Generating train split: 101246 examples [01:35, 1149.29 examples/s]Generating train split: 101611 examples [01:36, 926.92 examples/s] Generating train split: 102000 examples [01:36, 1159.08 examples/s]Generating train split: 102416 examples [01:37, 942.67 examples/s] Generating train split: 102923 examples [01:37, 1319.74 examples/s]Generating train split: 103222 examples [01:37, 832.75 examples/s] Generating train split: 103732 examples [01:38, 1187.86 examples/s]Generating train split: 104028 examples [01:38, 861.17 examples/s] Generating train split: 104534 examples [01:38, 1224.94 examples/s]Generating train split: 105000 examples [01:39, 967.03 examples/s] Generating train split: 105361 examples [01:39, 1196.13 examples/s]Generating train split: 105637 examples [01:40, 889.22 examples/s] Generating train split: 106000 examples [01:40, 965.04 examples/s]Generating train split: 106444 examples [01:41, 835.31 examples/s]Generating train split: 106948 examples [01:41, 1186.99 examples/s]Generating train split: 107244 examples [01:41, 1353.12 examples/s]Generating train split: 107501 examples [01:42, 892.69 examples/s] Generating train split: 108000 examples [01:42, 1231.02 examples/s]Generating train split: 108301 examples [01:42, 897.89 examples/s] Generating train split: 108807 examples [01:42, 1294.29 examples/s]Generating train split: 109245 examples [01:43, 879.40 examples/s] Generating train split: 109663 examples [01:44, 799.17 examples/s]Generating train split: 110000 examples [01:44, 956.85 examples/s]Generating train split: 110476 examples [01:45, 880.70 examples/s]Generating train split: 110958 examples [01:45, 1185.17 examples/s]Generating train split: 111244 examples [01:45, 1341.65 examples/s]Generating train split: 111535 examples [01:46, 872.21 examples/s] Generating train split: 112000 examples [01:46, 1170.20 examples/s]Generating train split: 112345 examples [01:46, 913.68 examples/s] Generating train split: 112840 examples [01:46, 1292.15 examples/s]Generating train split: 113247 examples [01:47, 955.96 examples/s] Generating train split: 113615 examples [01:47, 1202.35 examples/s]Generating train split: 113957 examples [01:48, 932.73 examples/s] Generating train split: 114245 examples [01:48, 1075.23 examples/s]Generating train split: 114517 examples [01:49, 729.63 examples/s] Generating train split: 115000 examples [01:49, 1018.30 examples/s]Generating train split: 115309 examples [01:49, 818.81 examples/s] Generating train split: 115816 examples [01:50, 1200.71 examples/s]Generating train split: 116113 examples [01:50, 854.10 examples/s] Generating train split: 116620 examples [01:50, 1233.62 examples/s]Generating train split: 116917 examples [01:51, 905.72 examples/s] Generating train split: 117246 examples [01:51, 1104.70 examples/s]Generating train split: 117723 examples [01:52, 852.16 examples/s] Generating train split: 118000 examples [01:52, 980.99 examples/s]Generating train split: 118490 examples [01:52, 1389.75 examples/s]Generating train split: 118782 examples [01:53, 957.27 examples/s] Generating train split: 119244 examples [01:53, 1262.97 examples/s]Generating train split: 119587 examples [01:53, 958.52 examples/s] Generating train split: 120000 examples [01:54, 1222.64 examples/s]Generating train split: 120396 examples [01:54, 853.12 examples/s] Generating train split: 120898 examples [01:54, 1208.66 examples/s]Generating train split: 121244 examples [01:55, 889.11 examples/s] Generating train split: 121738 examples [01:55, 1240.24 examples/s]Generating train split: 122244 examples [01:56, 976.19 examples/s] Generating train split: 122554 examples [01:57, 819.66 examples/s]Generating train split: 123000 examples [01:57, 1046.22 examples/s]Generating train split: 123361 examples [01:57, 794.15 examples/s] Generating train split: 123862 examples [01:58, 1122.70 examples/s]Generating train split: 124166 examples [01:58, 849.01 examples/s] Generating train split: 124665 examples [01:58, 1198.70 examples/s]Generating train split: 124971 examples [01:59, 900.92 examples/s] Generating train split: 125240 examples [01:59, 1051.22 examples/s]Generating train split: 125734 examples [01:59, 1490.82 examples/s]Generating train split: 126224 examples [02:00, 1071.65 examples/s]Generating train split: 126548 examples [02:00, 1050.44 examples/s]
max_steps is given, it will override any value given in num_train_epochs
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:432: UserWarning: You passed `packing=True` to the SFTTrainer/SFTConfig, and you are training your model with `max_steps` strategy. The dataset will be iterated until the `max_steps` are reached.
  warnings.warn(
max_steps is given, it will override any value given in num_train_epochs
Using auto half precision backend
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:432: UserWarning: You passed `packing=True` to the SFTTrainer/SFTConfig, and you are training your model with `max_steps` strategy. The dataset will be iterated until the `max_steps` are reached.
  warnings.warn(
STAGE:2024-08-03 01:45:51 2423053:2423053 ActivityProfilerController.cpp:314] Completed Stage: Warm UpSTAGE:2024-08-03 01:45:51 2423054:2423054 ActivityProfilerController.cpp:314] Completed Stage: Warm Up

Detected ZeRO Offload and non-DeepSpeed optimizers: This combination should work as long as the custom optimizer has both CPU and GPU implementation (except LAMB)
[rank1]:[W CPUAllocator.cpp:235] Memory block of unknown size was allocated before the profiling started, profiler results will not include the deallocation event
[rank0]:[W CPUAllocator.cpp:235] Memory block of unknown size was allocated before the profiling started, profiler results will not include the deallocation event
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
***** Running training *****
  Num examples = 126,548
  Num Epochs = 1
  Instantaneous batch size per device = 4
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 2
  Total optimization steps = 15
  Number of trainable parameters = 20,971,520
  0%|          | 0/15 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  7%|â–‹         | 1/15 [00:27<06:20, 27.15s/it] 13%|â–ˆâ–Ž        | 2/15 [00:35<03:25, 15.83s/it] 20%|â–ˆâ–ˆ        | 3/15 [00:43<02:27, 12.26s/it] 27%|â–ˆâ–ˆâ–‹       | 4/15 [00:51<01:56, 10.57s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 5/15 [00:58<01:36,  9.62s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 5/15 [00:58<01:36,  9.62s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 6/15 [01:07<01:21,  9.08s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 7/15 [01:14<01:09,  8.71s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 8/15 [01:23<00:59,  8.50s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 9/15 [01:31<00:50,  8.35s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 10/15 [01:39<00:41,  8.23s/it]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 10/15 [01:39<00:41,  8.23s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 11/15 [01:46<00:32,  8.15s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 12/15 [01:54<00:24,  8.09s/it]=>> PBS: job killed: walltime 308 exceeded limit 300
[2024-08-03 01:47:54,082] torch.distributed.elastic.agent.server.api: [WARNING] Received Signals.SIGTERM death signal, shutting down workers
[2024-08-03 01:47:54,083] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2423053 closing signal SIGTERM
[2024-08-03 01:47:54,083] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2423054 closing signal SIGTERM
Traceback (most recent call last):
  File "/home/binkma/.conda/envs/zero/bin/accelerate", line 33, in <module>
    sys.exit(load_entry_point('accelerate==0.33.0.dev0', 'console_scripts', 'accelerate')())
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/accelerate/commands/accelerate_cli.py", line 48, in main
    args.func(args)
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/accelerate/commands/launch.py", line 1091, in launch_command
    deepspeed_launcher(args)
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/accelerate/commands/launch.py", line 787, in deepspeed_launcher
    distrib_run.run(args)
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 259, in launch_agent
    result = agent.run()
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/torch/distributed/elastic/metrics/api.py", line 123, in wrapper
    result = f(*args, **kwargs)
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 727, in run
    result = self._invoke_run(role)
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 868, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/binkma/.conda/envs/zero/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 2422914 got signal: 15
